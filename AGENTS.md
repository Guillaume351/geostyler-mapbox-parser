# Repository Guidelines

## Project Structure & Module Organization
- `src/`: TypeScript sources and unit tests (e.g., `MapboxStyleParser.ts`, `*.spec.ts`).
- `src/Util/`: Parser utilities (e.g., `MapboxStyleUtil.ts`).
- `data/`: Style and Mapbox fixture data used by tests/examples.
- `dist/`: Build output (generated by `npm run build`).
- Config: `tsconfig*.json`, `vitest.config.ts`, `vite.config.ts`, `eslint.config.mjs`.

## Build, Test, and Development Commands
- `npm run build`: Builds browser bundle (Vite) and TypeScript dist.
- `npm run build-browser`: Produces IIFE bundle to `dist/` via Vite.
- `npm run build-dist`: Type-checks and emits `dist/` via `tsc`.
- `npm test`: Runs Vitest with coverage (`coverage/` with html, lcov, json).
- `npm run test-watch`: Watch mode for tests.
- `npm run lint`: ESLint + TypeScript type-checking (`--noEmit`).
- `npm run lint:test` or `lint:test:build`: Chain lint, test (and build).
- Requirements: Node >= 18, npm >= 9.

## Coding Style & Naming Conventions
- Language: TypeScript (ES2022 modules).
- Indentation: 2 spaces; quotes: single; end with semicolons.
- Imports: extensionless ES modules; keep paths relative within `src/`.
- Linting: `eslint.config.mjs` (extends `@terrestris/eslint-config-typescript`). Fix issues before PR.
- Types: Prefer explicit types; no `any` (tsconfig enables strict checks).

## Testing Guidelines
- Framework: Vitest + Istanbul coverage.
- Location/Pattern: co-located tests as `*.spec.ts` in `src/`.
- Run: `npm test` (CI expects passing tests and coverage artifacts in `coverage/`).
- Add tests for new behavior, edge cases, and bug fixes. Keep fixtures in `data/` when helpful.

## Commit & Pull Request Guidelines
- Conventional Commits enforced (`.commitlintrc.cjs`). Examples:
  - `feat(parser): support sprite size`
  - `fix(expressions): handle null operands`
  - `chore(release): prepare tooling`
- PRs: clear description, linked issues, test coverage for changes, updated docs, and screenshots for user-facing behavior.
- Versioning/Release: managed by semantic-release; do not bump versions manually or edit `CHANGELOG.md`.

## Security & Configuration Tips
- Do not commit secrets or private URLs in tests/fixtures.
- Keep changes scoped; avoid modifying `dist/` directly (generated).
